var params=JSON.parse(Base64.decode(window.location.hash.substring(1)));document.querySelector("#name").innerHTML=params.name;var currentTimeDom=document.querySelector("#current_time"),duration=-1,currentTime=-1,audio=document.querySelector("#audio"),progress=document.getElementById("progress"),bar=progress.children[0],hang=bar.children[0],mask=bar.children[1];function updateCurrentTime(){setTimeout(function(){audio.paused||(currentTimeDom.innerHTML=durationFormat(audio.currentTime),updateCurrentTime())},500)}function durationFormat(e){var t="",o=parseInt(Math.floor(e/3600),10),r=parseInt(Math.floor(e/60)%60,10),n=parseInt(e%60,10);return o>0&&(t=o<10?"0"+o+":":o+":"),r<10&&(t+="0"),t+=r+":",n<10&&(t+="0"),t+=n}function toggleAudio(){duration>-1&&(audio.paused?audio.play():audio.pause())}mask.onmousedown=function(e){if(duration>-1){var t=(e=e||window.event).clientX-mask.offsetLeft;document.onmousemove=function(e){audio.pause();var o=(e=e||window.event).clientX-t;return o<0?o=0:o>=bar.offsetWidth-mask.offsetWidth&&(o=bar.offsetWidth-mask.offsetWidth),mask.style.left=o+"px",hang.style.width=o+"px",currentTime=duration*(o/(bar.offsetWidth-mask.offsetWidth)),currentTimeDom.innerHTML=durationFormat(currentTime),!1},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,audio.currentTime=currentTime,audio.play()}}return!1},audio.setAttribute("src",params.source),audio.load(),audio.onpause=function(){document.querySelector("#toggle").setAttribute("class","toggle"),currentTimeDom.innerHTML=durationFormat(audio.currentTime)},audio.onplay=function(){document.querySelector("#toggle").setAttribute("class","toggle playing"),currentTimeDom.innerHTML=durationFormat(audio.currentTime),updateCurrentTime()},audio.oncanplay=function(){(duration=parseInt(audio.duration,10))>-1&&(mask.setAttribute("class","show"),document.querySelector("#duration").innerHTML=durationFormat(duration))};