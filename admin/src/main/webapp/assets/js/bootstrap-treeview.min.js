(function(f,d,b,h){var e="treeview";var a={};a.settings={injectStyle:true,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"",selectedIcon:"",checkedIcon:"glyphicon glyphicon-check",uncheckedIcon:"glyphicon glyphicon-unchecked",color:h,backColor:h,borderColor:h,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#23b7e5",searchResultColor:"#f05050",searchResultBackColor:h,enableLinks:false,highlightSelected:true,highlightSearchResults:true,showBorder:true,showIcon:true,showCheckbox:false,showTags:false,multiSelect:false,onNodeChecked:h,onNodeCollapsed:h,onNodeDisabled:h,onNodeEnabled:h,onNodeExpanded:h,onNodeSelected:h,onNodeUnchecked:h,onNodeUnselected:h,onSearchComplete:h,onSearchCleared:h,titleKey:"name",nodeKey:"children",idKey:"id",toggle:true};a.options={silent:false,ignoreChildren:false};a.searchOptions={ignoreCase:true,exactMatch:false,revealResults:true};var g=function(j,i){this.$element=f(j);this.elementId=j.id;this.styleId=this.elementId+"-style";this.init(i);return{options:this.options,init:f.proxy(this.init,this),remove:f.proxy(this.remove,this),getNode:f.proxy(this.getNode,this),getParent:f.proxy(this.getParent,this),getSiblings:f.proxy(this.getSiblings,this),getSelected:f.proxy(this.getSelected,this),getUnselected:f.proxy(this.getUnselected,this),getExpanded:f.proxy(this.getExpanded,this),getCollapsed:f.proxy(this.getCollapsed,this),getChecked:f.proxy(this.getChecked,this),getUnchecked:f.proxy(this.getUnchecked,this),getDisabled:f.proxy(this.getDisabled,this),getEnabled:f.proxy(this.getEnabled,this),selectNode:f.proxy(this.selectNode,this),unselectNode:f.proxy(this.unselectNode,this),toggleNodeSelected:f.proxy(this.toggleNodeSelected,this),collapseAll:f.proxy(this.collapseAll,this),collapseNode:f.proxy(this.collapseNode,this),expandAll:f.proxy(this.expandAll,this),expandNode:f.proxy(this.expandNode,this),toggleNodeExpanded:f.proxy(this.toggleNodeExpanded,this),revealNode:f.proxy(this.revealNode,this),checkAll:f.proxy(this.checkAll,this),checkNode:f.proxy(this.checkNode,this),uncheckAll:f.proxy(this.uncheckAll,this),uncheckNode:f.proxy(this.uncheckNode,this),toggleNodeChecked:f.proxy(this.toggleNodeChecked,this),disableAll:f.proxy(this.disableAll,this),disableNode:f.proxy(this.disableNode,this),enableAll:f.proxy(this.enableAll,this),enableNode:f.proxy(this.enableNode,this),toggleNodeDisabled:f.proxy(this.toggleNodeDisabled,this),search:f.proxy(this.search,this),clearSearch:f.proxy(this.clearSearch,this)}};g.prototype.init=function(j){this.tree=[];this.nodes=[];if(j.data){if(typeof j.data==="string"){j.data=f.parseJSON(j.data)}this.tree=f.extend(true,[],j.data);delete j.data}this.options=f.extend({},a.settings,j);this.destroy();this.subscribeEvents();var i={};i[this.options.nodeKey]=this.tree;this.setInitialStates(i,0);this.render()};g.prototype.remove=function(){this.destroy();f.removeData(this,e);f("#"+this.styleId).remove()};g.prototype.destroy=function(){if(!this.initialized){return}this.$wrapper.remove();this.$wrapper=null;this.unsubscribeEvents();this.initialized=false};g.prototype.unsubscribeEvents=function(){this.$element.off("click");this.$element.off("nodeChecked");this.$element.off("nodeCollapsed");this.$element.off("nodeDisabled");this.$element.off("nodeEnabled");this.$element.off("nodeExpanded");this.$element.off("nodeSelected");this.$element.off("nodeUnchecked");this.$element.off("nodeUnselected");this.$element.off("searchComplete");this.$element.off("searchCleared")};g.prototype.subscribeEvents=function(){this.unsubscribeEvents();this.$element.on("click",f.proxy(this.clickHandler,this));if(typeof(this.options.onNodeChecked)==="function"){this.$element.on("nodeChecked",this.options.onNodeChecked)}if(typeof(this.options.onNodeCollapsed)==="function"){this.$element.on("nodeCollapsed",this.options.onNodeCollapsed)}if(typeof(this.options.onNodeDisabled)==="function"){this.$element.on("nodeDisabled",this.options.onNodeDisabled)}if(typeof(this.options.onNodeEnabled)==="function"){this.$element.on("nodeEnabled",this.options.onNodeEnabled)}if(typeof(this.options.onNodeExpanded)==="function"){this.$element.on("nodeExpanded",this.options.onNodeExpanded)}if(typeof(this.options.onNodeSelected)==="function"){this.$element.on("nodeSelected",this.options.onNodeSelected)}if(typeof(this.options.onNodeUnchecked)==="function"){this.$element.on("nodeUnchecked",this.options.onNodeUnchecked)}if(typeof(this.options.onNodeUnselected)==="function"){this.$element.on("nodeUnselected",this.options.onNodeUnselected)}if(typeof(this.options.onSearchComplete)==="function"){this.$element.on("searchComplete",this.options.onSearchComplete)}if(typeof(this.options.onSearchCleared)==="function"){this.$element.on("searchCleared",this.options.onSearchCleared)}};g.prototype.setInitialStates=function(k,m){if(!k[this.options.nodeKey]){return}m+=1;var i=k;var l=this;f.each(k[this.options.nodeKey],function j(n,o){o.nodeId=o.id;o.parentId=i.nodeId;if(!o.hasOwnProperty("selectable")){o.selectable=true}o.state=o.state||{};if(!o.state.hasOwnProperty("checked")){o.state.checked=false}if(!o.state.hasOwnProperty("disabled")){o.state.disabled=false}if(!o.state.hasOwnProperty("expanded")){if(!o.state.disabled&&(m<l.options.levels)&&(o[l.options.nodeKey]&&o[l.options.nodeKey].length>0)){o.state.expanded=true}else{o.state.expanded=false}}if(!o.state.hasOwnProperty("selected")){o.state.selected=false}l.nodes[o.nodeId]=o;if(o[l.options.nodeKey]){l.setInitialStates(o,m)}})};g.prototype.clickHandler=function(j){if(!this.options.enableLinks){j.preventDefault()}var k=f(j.target);var i=this.findNode(k);if(!i||i.state.disabled){return}var l=k.attr("class")?k.attr("class").split(" "):[];if((l.indexOf("expand-icon")!==-1)){this.toggleExpandedState(i,a.options);this.render()}else{if((l.indexOf("check-icon")!==-1)){this.toggleCheckedState(i,a.options);this.render()}else{if(i.selectable){if(this.options.toggle){this.toggleSelectedState(i,a.options)}else{if(!i.state.selected){this.toggleSelectedState(i,a.options)}}}else{this.toggleExpandedState(i,a.options)}this.render()}}};g.prototype.findNode=function(j){var k=j.closest("li.list-group-item").attr("data-nodeid");var i=this.nodes[k];if(!i){console.log("Error: node does not exist")}return i};g.prototype.toggleExpandedState=function(j,i){if(!j){return}this.setExpandedState(j,!j.state.expanded,i)};g.prototype.setExpandedState=function(j,k,i){if(k===j.state.expanded){return}if(k&&j[this.options.nodeKey]){j.state.expanded=true;if(!i.silent){this.$element.trigger("nodeExpanded",f.extend(true,{},j))}}else{if(!k){j.state.expanded=false;if(!i.silent){this.$element.trigger("nodeCollapsed",f.extend(true,{},j))}if(j[this.options.nodeKey]&&!i.ignoreChildren){f.each(j[this.options.nodeKey],f.proxy(function(l,m){this.setExpandedState(m,false,i)},this))}}}};g.prototype.toggleSelectedState=function(j,i){if(!j){return}this.setSelectedState(j,!j.state.selected,i)};g.prototype.setSelectedState=function(j,k,i){if(k===j.state.selected){return}if(k){if(!this.options.multiSelect){f.each(this.findNodes("true","g","state.selected"),f.proxy(function(l,m){this.setSelectedState(m,false,i)},this))}j.state.selected=true;if(!i.silent){this.$element.trigger("nodeSelected",f.extend(true,{},j))}}else{j.state.selected=false;if(!i.silent){this.$element.trigger("nodeUnselected",f.extend(true,{},j))}}};g.prototype.toggleCheckedState=function(j,i){if(!j){return}this.setCheckedState(j,!j.state.checked,i)};g.prototype.setCheckedState=function(j,k,i){if(k===j.state.checked){return}if(k){j.state.checked=true;if(!i.silent){this.$element.trigger("nodeChecked",f.extend(true,{},j))}}else{j.state.checked=false;if(!i.silent){this.$element.trigger("nodeUnchecked",f.extend(true,{},j))}}};g.prototype.setDisabledState=function(j,k,i){if(k===j.state.disabled){return}if(k){j.state.disabled=true;this.setExpandedState(j,false,i);this.setSelectedState(j,false,i);this.setCheckedState(j,false,i);if(!i.silent){this.$element.trigger("nodeDisabled",f.extend(true,{},j))}}else{j.state.disabled=false;if(!i.silent){this.$element.trigger("nodeEnabled",f.extend(true,{},j))}}};g.prototype.render=function(){if(!this.initialized){this.$element.addClass(e);this.$wrapper=f(this.template.list);this.injectStyle();this.initialized=true}this.$element.empty().append(this.$wrapper.empty());this.buildTree(this.tree,0)};g.prototype.buildTree=function(j,l){if(!j){return}l+=1;var k=this;f.each(j,function i(r,o){var p=f(k.template.item).addClass("node-"+k.elementId).addClass(o.state.checked?"node-checked":"").addClass(o.state.disabled?"node-disabled":"").addClass(o.state.selected?"node-selected":"").addClass(o.searchResult?"search-result":"").attr("data-nodeid",o.nodeId).attr("style",k.buildStyleOverride(o));for(var n=0;n<(l-1);n++){p.append(k.template.indent)}var q=[];if(o[k.options.nodeKey]){q.push("expand-icon");if(o.state.expanded){q.push(k.options.collapseIcon)}else{q.push(k.options.expandIcon)}}else{q.push(k.options.emptyIcon)}p.append(f(k.template.icon).addClass(q.join(" ")));if(k.options.showIcon){var q=["node-icon"];q.push(o.icon||k.options.nodeIcon);if(o.state.selected){q.pop();q.push(o.selectedIcon||k.options.selectedIcon||o.icon||k.options.nodeIcon)}p.append(f(k.template.icon).addClass(q.join(" ")))}if(k.options.showCheckbox){var q=["check-icon"];if(o.state.checked){q.push(k.options.checkedIcon)}else{q.push(k.options.uncheckedIcon)}p.append(f(k.template.icon).addClass(q.join(" ")))}if(k.options.enableLinks){p.append(f(k.template.link).attr("href",o.href).append(o[k.options.titleKey]))}else{p.append(o[k.options.titleKey])}if(k.options.showTags&&o.tags){f.each(o.tags,function m(t,s){p.append(f(k.template.badge).append(s))})}k.$wrapper.append(p);if(o[k.options.nodeKey]&&o.state.expanded&&!o.state.disabled){return k.buildTree(o[k.options.nodeKey],l)}})};g.prototype.buildStyleOverride=function(k){if(k.state.disabled){return""}var j=k.color;var i=k.backColor;if(this.options.highlightSelected&&k.state.selected){if(this.options.selectedColor){j=this.options.selectedColor}if(this.options.selectedBackColor){i=this.options.selectedBackColor}}if(this.options.highlightSearchResults&&k.searchResult&&!k.state.disabled){if(this.options.searchResultColor){j=this.options.searchResultColor}if(this.options.searchResultBackColor){i=this.options.searchResultBackColor}}return"color:"+j+";background-color:"+i+";"};g.prototype.injectStyle=function(){if(this.options.injectStyle&&!b.getElementById(this.styleId)){f('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")}};g.prototype.buildStyle=function(){var i=".node-"+this.elementId+"{";if(this.options.color){i+="color:"+this.options.color+";"}if(this.options.backColor){i+="background-color:"+this.options.backColor+";"}if(!this.options.showBorder){i+="border:none;"}else{if(this.options.borderColor){i+="border:1px solid "+this.options.borderColor+";"}}i+="}";if(this.options.onhoverColor){i+=".node-"+this.elementId+":not(.node-disabled):hover{background-color:"+this.options.onhoverColor+";}"}return this.css+i};g.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'};g.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}";g.prototype.getNode=function(i){return this.nodes[i]};g.prototype.getParent=function(i){var j=this.identifyNode(i);return this.nodes[j.parentId]};g.prototype.getSiblings=function(j){var l=this.identifyNode(j);var k=this.getParent(l);var i=k?k.nodes:this.tree;return i.filter(function(m){return m.nodeId!==l.nodeId})};g.prototype.getSelected=function(){return this.findNodes("true","g","state.selected")};g.prototype.getUnselected=function(){return this.findNodes("false","g","state.selected")};g.prototype.getExpanded=function(){return this.findNodes("true","g","state.expanded")};g.prototype.getCollapsed=function(){return this.findNodes("false","g","state.expanded")};g.prototype.getChecked=function(){return this.findNodes("true","g","state.checked")};g.prototype.getUnchecked=function(){return this.findNodes("false","g","state.checked")};g.prototype.getDisabled=function(){return this.findNodes("true","g","state.disabled")};g.prototype.getEnabled=function(){return this.findNodes("false","g","state.disabled")};g.prototype.selectNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setSelectedState(l,true,k)},this));this.render()};g.prototype.unselectNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setSelectedState(l,false,k)},this));this.render()};g.prototype.toggleNodeSelected=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.toggleSelectedState(l,k)},this));this.render()};g.prototype.collapseAll=function(j){var i=this.findNodes("true","g","state.expanded");this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setExpandedState(l,false,k)},this));this.render()};g.prototype.collapseNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setExpandedState(l,false,k)},this));this.render()};g.prototype.expandAll=function(j){j=f.extend({},a.options,j);if(j&&j.levels){this.expandLevels(this.tree,j.levels,j)}else{var i=this.findNodes("false","g","state.expanded");this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setExpandedState(l,true,k)},this))}this.render()};g.prototype.expandNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setExpandedState(l,true,k);if(l[k.nodeKey]&&(k&&k.levels)){this.expandLevels(l[k.nodeKey],k.levels-1,k)}},this));this.render()};g.prototype.expandLevels=function(i,k,j){j=f.extend({},a.options,j);f.each(i,f.proxy(function(l,m){this.setExpandedState(m,(k>0)?true:false,j);if(m[j.nodeKey]){this.expandLevels(m[j.nodeKey],k-1,j)}},this))};g.prototype.revealNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(m,l){var k=this.getParent(m);while(k){this.setExpandedState(k,true,l);k=this.getParent(k)}},this));this.render()};g.prototype.toggleNodeExpanded=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.toggleExpandedState(l,k)},this));this.render()};g.prototype.checkAll=function(j){var i=this.findNodes("false","g","state.checked");this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setCheckedState(l,true,k)},this));this.render()};g.prototype.checkNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setCheckedState(l,true,k)},this));this.render()};g.prototype.uncheckAll=function(j){var i=this.findNodes("true","g","state.checked");this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setCheckedState(l,false,k)},this));this.render()};g.prototype.uncheckNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setCheckedState(l,false,k)},this));this.render()};g.prototype.toggleNodeChecked=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.toggleCheckedState(l,k)},this));this.render()};g.prototype.disableAll=function(j){var i=this.findNodes("false","g","state.disabled");this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setDisabledState(l,true,k)},this));this.render()};g.prototype.disableNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setDisabledState(l,true,k)},this));this.render()};g.prototype.enableAll=function(j){var i=this.findNodes("true","g","state.disabled");this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setDisabledState(l,false,k)},this));this.render()};g.prototype.enableNode=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setDisabledState(l,false,k)},this));this.render()};g.prototype.toggleNodeDisabled=function(i,j){this.forEachIdentifier(i,j,f.proxy(function(l,k){this.setDisabledState(l,!l.state.disabled,k)},this));this.render()};g.prototype.forEachIdentifier=function(j,k,m){k=f.extend({},a.options,k);if(!(j instanceof Array)){m(this.nodes[j],k)}else{for(var l=0;l<j.length;l++){m(this.nodes[j[l].id],k)}}};g.prototype.identifyNode=function(i){return this.nodes[i]};g.prototype.search=function(l,j){j=f.extend({},a.searchOptions,j);this.clearSearch({render:false});var k=[];if(l&&l.length>0){if(j.exactMatch){l="^"+l+"$"}var i="g";if(j.ignoreCase){i+="i"}k=this.findNodes(l,i);f.each(k,function(m,n){n.searchResult=true})}if(j.revealResults){this.revealNode(k)}else{this.render()}this.$element.trigger("searchComplete",f.extend(true,{},k));return k};g.prototype.clearSearch=function(i){i=f.extend({},{render:true},i);var j=f.each(this.findNodes("true","g","searchResult"),function(k,l){l.searchResult=false});if(i.render){this.render()}this.$element.trigger("searchCleared",f.extend(true,{},j))};g.prototype.findNodes=function(m,i,l){i=i||"g";l=l||"text";var o=this;var j=[];for(var k in this.nodes){var n=o.getNodeValue(this.nodes[k],l);if(typeof n==="string"&&n.match(new RegExp(m,i))){j.push(this.nodes[k])}}return j};g.prototype.getNodeValue=function(k,i){var j=i.indexOf(".");if(j>0){var m=k[i.substring(0,j)];var l=i.substring(j+1,i.length);return this.getNodeValue(m,l)}else{if(k.hasOwnProperty(i)){return k[i].toString()}else{return h}}};var c=function(i){if(d.console){d.console.error(i)}};f.fn[e]=function(k,j){var i;this.each(function(){var l=f.data(this,e);if(typeof k==="string"){if(!l){c("Not initialized, can not call method : "+k)}else{if(!f.isFunction(l[k])||k.charAt(0)==="_"){c("No such method : "+k)}else{if(!(j instanceof Array)){j=[j]}i=l[k].apply(l,j)}}}else{if(typeof k==="boolean"){i=l}else{f.data(this,e,new g(this,f.extend(true,{},k)))}}});return i||this}})(jQuery,window,document);